[{"idx":0,"id":"18721c4b-1fb2-4769-8942-9c522692a047","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Slack Mention Alert","description":"Sends a DM when @Juniper is mentioned in a Slack channel","trigger_type":"webhook","trigger_config":"{\"service\": \"slack\", \"event_type\": \"app_mention\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 19:54:59.273965+00","updated_at":"2025-12-10 19:54:59.273966+00","actions":"[{\"id\": \"send_dm_alert\", \"tool\": \"slack_send_dm\", \"parameters\": {\"text\": \"You were mentioned!\", \"user\": \"{{trigger_data.event.user}}\"}}]","variables":"{}","status":"active","confirmed_at":"2025-12-10 19:54:59.273959+00"},{"idx":1,"id":"45cb71e8-8181-47b9-91a0-1b3351d0ff16","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Gmail New Email Notification","description":"Sends a system notification email when a new Gmail message is received, including sender, subject, and first 100 characters of the body","trigger_type":"webhook","trigger_config":"{\"service\": \"gmail\", \"event_type\": \"message_received\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 12:45:10.823599+00","updated_at":"2025-12-11 02:21:35.603796+00","actions":"[{\"id\": \"get_latest_messages\", \"tool\": \"gmail_get_messages\", \"output_as\": \"messages\", \"parameters\": {\"label_ids\": [\"INBOX\", \"UNREAD\"], \"max_results\": 1}}, {\"id\": \"send_notification\", \"tool\": \"smtp_send_email\", \"parameters\": {\"to\": \"{{user.email}}\", \"body\": \"You have a new email in your inbox!\\n\\nCheck your Gmail for details.\\n\\nHistory ID: {{trigger_data.history_id}}\", \"subject\": \"New Gmail Email Received\"}}]","variables":"{}","status":"active","confirmed_at":"2025-12-10 12:45:10.823582+00"},{"idx":2,"id":"02156eab-4945-4379-b2ae-fb1e15f81c03","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Outlook New Email Notification","description":"Sends a notification when a new Outlook email is received, including sender, subject, and preview","trigger_type":"webhook","trigger_config":"{\"service\": \"outlook\", \"event_type\": \"item_created\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-11 02:06:42.308301+00","updated_at":"2025-12-11 02:21:35.785843+00","actions":"[{\"id\": \"read_email\", \"tool\": \"outlook_mail_read_message\", \"output_as\": \"email_details\", \"parameters\": {\"message_id\": \"{{trigger_data.resource_data.id}}\"}}, {\"id\": \"send_notification\", \"tool\": \"smtp_send_email\", \"parameters\": {\"to\": \"{{user.email}}\", \"body\": \"You have a new Outlook email!\\n\\nFrom: {{email_details.from}}\\nSubject: {{email_details.subject}}\\n\\nPreview: {{email_details.body_preview}}\", \"subject\": \"New Outlook Email Received\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":3,"id":"6a0a9b88-2e81-48ff-8d68-ed8536fb1cc9","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Test Fitbit Webhook - Sleep Alert","description":"Test automation: Text me when Fitbit syncs sleep data","trigger_type":"webhook","trigger_config":"{\"service\": \"fitbit\", \"event_types\": [\"sleep\"]}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 07:42:06.239584+00","updated_at":"2025-12-10 07:42:06.239589+00","actions":"[{\"id\": \"send_alert\", \"tool\": \"textbelt_send_sms\", \"parameters\": {\"phone\": \"{{user.phone}}\", \"message\": \"Fitbit webhook test: Sleep data synced at {{now}}\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":4,"id":"cbac3f75-24cb-4f3e-bd07-b08649751cea","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Bad Sleep Alert","description":"Checks yesterday and two days ago sleep scores from Oura. If both are below 70, sends SMS alert to prioritize rest.","trigger_type":"schedule_recurring","trigger_config":"{\"interval\": \"daily\", \"time_of_day\": \"08:00\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-09 00:04:59.736101+00","updated_at":"2025-12-10 10:45:39.997753+00","actions":"[{\"id\": \"get_yesterday_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"yesterday_sleep\", \"parameters\": {\"end_date\": \"{{yesterday}}\", \"start_date\": \"{{yesterday}}\"}}, {\"id\": \"get_previous_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"previous_sleep\", \"parameters\": {\"end_date\": \"{{two_days_ago}}\", \"start_date\": \"{{two_days_ago}}\"}}, {\"id\": \"send_alert\", \"tool\": \"textbelt_send_sms\", \"condition\": {\"clauses\": [{\"op\": \"<\", \"path\": \"yesterday_sleep.data.0.score\", \"value\": 70}, {\"op\": \"<\", \"path\": \"previous_sleep.data.0.score\", \"value\": 70}], \"operator\": \"AND\"}, \"parameters\": {\"message\": \"Two consecutive nights of poor sleep. Prioritize rest tonight!\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":5,"id":"a552b9af-b166-42f4-8c6e-7fce98121083","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Bad Sleep Alert","description":"Checks last two days of Oura sleep data and sends SMS alert if both nights had sleep scores below 70","trigger_type":"schedule_recurring","trigger_config":"{\"interval\": \"daily\", \"time_of_day\": \"08:00\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-08 23:16:32.937194+00","updated_at":"2025-12-10 10:45:39.997753+00","actions":"[{\"id\": \"get_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"sleep_data\", \"parameters\": {\"end_date\": \"{{yesterday}}\", \"start_date\": \"{{two_days_ago}}\"}}, {\"id\": \"send_alert\", \"tool\": \"textbelt_send_sms\", \"condition\": {\"clauses\": [{\"op\": \"<\", \"path\": \"sleep_data.data.0.score\", \"value\": 70}, {\"op\": \"<\", \"path\": \"sleep_data.data.1.score\", \"value\": 70}], \"operator\": \"AND\"}, \"parameters\": {\"message\": \"Two rough nights of sleep in a row. Prioritize rest tonight!\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":6,"id":"524a5d67-a0a5-45bd-9c86-f32eaad98d1e","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Daily Wellness Summary","description":"Fetches yesterday's sleep data from Oura, analyzes it with AI to provide personalized wellness recommendations, and emails the summary","trigger_type":"schedule_recurring","trigger_config":"{\"interval\": \"daily\", \"time_of_day\": \"08:00\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-09 00:03:33.470477+00","updated_at":"2025-12-10 10:45:39.997753+00","actions":"[{\"id\": \"fetch_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"sleep_data\", \"parameters\": {\"end_date\": \"{{yesterday}}\", \"start_date\": \"{{yesterday}}\"}}, {\"id\": \"analyze_wellness\", \"tool\": \"juniper_call_agent\", \"output_as\": \"wellness_summary\", \"parameters\": {\"context\": {\"sleep_data\": \"{{sleep_data}}\"}, \"message\": \"Analyze this sleep data from yesterday and provide a personalized wellness recommendation. Focus on sleep quality, duration, and any areas for improvement. Keep the response concise and actionable.\"}}, {\"id\": \"send_email\", \"tool\": \"gmail_send_email\", \"parameters\": {\"to\": \"{{user.email}}\", \"body\": \"{{wellness_summary}}\", \"subject\": \"Your Daily Wellness Summary\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":7,"id":"42a03a7f-f518-492c-b44f-330a53549780","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Scheduler Cron Test (5min)","description":"Test automation to verify pg_cron -> scheduler-runner -> script-executor flow","trigger_type":"schedule_recurring","trigger_config":"{\"interval\": \"5min\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":false,"created_at":"2025-12-09 17:54:08.427977+00","updated_at":"2025-12-10 10:45:39.997753+00","actions":"[{\"id\": \"log_execution\", \"tool\": \"juniper_call_agent\", \"output_as\": \"juniper_response\", \"parameters\": {\"message\": \"Scheduler cron test executed successfully at {{today}}\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":8,"id":"d3192d75-2da9-4bbd-a609-b49214189817","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Low Sleep Score Alert","description":"Checks Oura sleep data daily and sends SMS alert if sleep score is below 70","trigger_type":"schedule_recurring","trigger_config":"{\"interval\": \"daily\", \"time_of_day\": \"08:00\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 12:51:59.741358+00","updated_at":"2025-12-10 12:51:59.741358+00","actions":"[{\"id\": \"get_sleep_data\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"sleep_data\", \"parameters\": {\"end_date\": \"{{yesterday}}\", \"start_date\": \"{{yesterday}}\"}}, {\"id\": \"send_alert\", \"tool\": \"textbelt_send_sms\", \"condition\": {\"op\": \"<\", \"path\": \"sleep_data.data.0.score\", \"value\": 70}, \"parameters\": {\"message\": \"Sleep Alert: Your Oura sleep score was {{sleep_data.data.0.score}} yesterday, which is below 70. Consider prioritizing rest tonight!\"}}]","variables":"{}","status":"active","confirmed_at":"2025-12-10 12:51:59.741356+00"},{"idx":9,"id":"1ceb7f4b-c67f-4e38-966b-6572cfafc8d6","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Test One-Time Automation","description":null,"trigger_type":"schedule_once","trigger_config":"{\"run_at\": \"2025-12-09T18:23:23.787882Z\", \"interval\": \"once\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":false,"created_at":"2025-12-09 18:24:24.214117+00","updated_at":"2025-12-10 10:45:39.997753+00","actions":"[{\"id\": \"action_1\", \"tool\": \"send_sms\", \"params\": {\"message\": \"Test one-time job executed!\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":10,"id":"c146929f-63a5-48dd-8890-f65ef759aed5","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Slack Mention Email Alert","description":"Monitors #general channel for mentions and sends email summaries when mentioned","trigger_type":"polling","trigger_config":"{\"service\": \"slack\", \"event_type\": \"message.mention\", \"poll_interval\": \"5min\"}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 12:55:29.368163+00","updated_at":"2025-12-10 12:55:29.368164+00","actions":"[{\"id\": \"get_channel_history\", \"tool\": \"slack_get_history\", \"output_as\": \"recent_messages\", \"parameters\": {\"limit\": 10, \"channel\": \"general\"}}, {\"id\": \"summarize_mention\", \"tool\": \"juniper_call_agent\", \"output_as\": \"summary\", \"parameters\": {\"context\": \"{{trigger_data}}\", \"message\": \"Summarize this Slack message that mentioned me. Focus on who sent it, what they said, and any action items or questions directed at me.\"}}, {\"id\": \"send_email_notification\", \"tool\": \"gmail_send_email\", \"parameters\": {\"to\": \"cameron.hightower@proton.me\", \"body\": \"{{summary}}\\n\\n---\\nOriginal message: {{trigger_data.text}}\\nFrom: {{trigger_data.user}}\\nTime: {{trigger_data.ts}}\", \"subject\": \"You were mentioned in #general on Slack\"}}]","variables":"{}","status":"active","confirmed_at":"2025-12-10 12:55:29.368158+00"},{"idx":11,"id":"feac4902-6842-481c-a451-855b44557ff8","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Test Email - Comprehensive Test Success","description":"Send a test email to verify automation system functionality","trigger_type":"manual","trigger_config":"{}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-10 12:49:08.347811+00","updated_at":"2025-12-10 12:49:08.347813+00","actions":"[{\"id\": \"send_test_email\", \"tool\": \"gmail_send_email\", \"parameters\": {\"to\": \"cmrn.hightower@gmail.com\", \"body\": \"This automation was triggered by the comprehensive test suite.\", \"subject\": \"Comprehensive Test Success\"}}]","variables":"{}","status":"active","confirmed_at":"2025-12-10 12:49:08.347808+00"},{"idx":12,"id":"c000b578-8f32-42e0-a2e5-f81cabe5df3c","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"E2E Test - Oura Sleep Fetch","description":"Test automation to fetch Oura sleep data","trigger_type":"manual","trigger_config":"{}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-08 17:26:41.859361+00","updated_at":"2025-12-08 17:26:41.859368+00","actions":"[{\"id\": \"fetch_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"sleep_data\", \"parameters\": {\"end_date\": \"{{today}}\", \"start_date\": \"{{yesterday}}\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":13,"id":"a7d450f0-9a98-4942-906d-0b922e7e0cd3","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"E2E Test - Oura Sleep Fetch","description":"Test automation to fetch Oura sleep data","trigger_type":"manual","trigger_config":"{}","script_code":null,"execution_params":"{}","dependencies":[],"active":true,"created_at":"2025-12-08 17:28:09.38212+00","updated_at":"2025-12-08 17:28:09.382125+00","actions":"[{\"id\": \"fetch_sleep\", \"tool\": \"oura_get_daily_sleep\", \"output_as\": \"sleep_data\", \"parameters\": {\"end_date\": \"{{today}}\", \"start_date\": \"{{yesterday}}\"}}]","variables":"{}","status":"active","confirmed_at":null},{"idx":14,"id":"6a6dbfa5-350b-4105-b96b-cbd07d13850c","user_id":"56a2c117-6486-4ca5-a57d-6c2e877e7083","name":"Test Email Sender","description":"Sends a test email with subject 'Comprehensive Test Success'","trigger_type":"manual","trigger_config":"{}","script_code":"import json\nimport base64\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom datetime import datetime\nfrom typing import Dict, Any\n\n  def track_usage(context: Dict[str, Any], service_name: str, \n  operation_type: str = 'api_call', tokens_used: int = 1) -> None:\n      \"\"\"Track service usage for automation execution\"\"\"\n      try:\n          # Get user_id and automation_id from context\n          user_id = context.get('user_id')\n          automation_id = context.get('automation_id')\n\n          if user_id and automation_id:\n              # Log usage to automation_usage table\n              usage_data = {\n                  'user_id': user_id,\n                  'automation_id': automation_id,\n                  'service_name': service_name,\n                  'timestamp': datetime.now().isoformat(),\n                  'tokens_used': tokens_used,\n                  'execution_time_ms': 0  # Placeholder - filled by \n  framework\n              }\n\n              # Store in context for framework to process\n              if 'usage_tracker' not in context:\n                  context['usage_tracker'] = []\n              context['usage_tracker'].append(usage_data)\n      except Exception as e:\n          # Don't fail automation if tracking fails\n          print(f'Usage tracking failed: {e}')\n\n  def execute_automation(context: Dict[str, Any]) -> Dict[str, Any]:\n      \"\"\"Execute the automation logic\"\"\"\n      results = {}\n      errors = []\n\n      try:\n          # Track usage before Gmail API call\n          track_usage(context, 'Gmail', 'api_call')\n\n          # Create email message\n          message = MIMEMultipart()\n          message['to'] = context['user_email']  # Will be populated \n  by framework\n          message['subject'] = 'Comprehensive Test Success with Usage \n  Tracking'\n\n          # Add body\n          body = 'This automation was triggered by the comprehensive \n  test suite and includes proper usage tracking.'\n          message.attach(MIMEText(body, 'plain'))\n\n          # Encode the message\n          raw =\n  base64.urlsafe_b64encode(message.as_bytes()).decode('utf-8')\n\n          # Track detailed Gmail operation\n          track_usage(context, 'Gmail', 'email_compose',\n  tokens_used=3)\n\n          # Send email using Gmail API\n          gmail = context['services']['Gmail']\n          response = gmail.users().messages().send(\n              userId='me',\n              body={'raw': raw}\n          ).execute()\n\n          results['message_id'] = response['id']\n          results['thread_id'] = response['threadId']\n\n          # Track successful completion\n          track_usage(context, 'Gmail', 'operation_complete')\n\n      except Exception as e:\n          errors.append(f'Gmail error: {str(e)}')\n          # Track error for monitoring\n          track_usage(context, 'Gmail', 'error')\n\n      return {\n          'success': len(errors) == 0,\n          'results': results,\n          'errors': errors,\n          'executed_at': datetime.now().isoformat()\n      }","execution_params":"{\"timeout\": 30, \"retry_count\": 1}","dependencies":["Gmail"],"active":true,"created_at":"2025-08-24 15:58:11.600573+00","updated_at":"2025-08-24 23:18:47.793449+00","actions":null,"variables":"{}","status":"active","confirmed_at":null}]